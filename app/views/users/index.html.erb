<%= provide(:title, "All Users") %>
<div class="container">
  <h1>全てのユーザー</h1>
  <div class="row">
    <div class="form-inline">
      <div class="col-md-4 col-md-offset-8",style="display:inline;">
        <%= form_with(url:users_path, method: :get, local:true) do |f| %>
          <span><%= f.label:search,"ユーザー名検索" %></span>
          <span style="display:inline;"><%= f.text_field:search, placeholder:"キーワードを入力…", class: "form-control" %><%= f.submit "検索", class: "btn btn-primary" %></span>
        <% end %>
      </div>
    </div>
    <div class="col-md-4">
      <form enctype="multipart/form-data" action="/users/import" accept-charset="UTF-8" method="post">
        <div class="search_item">
          <input type="button" name="commit" value="ファイル選択" class="csv_input_btn" onclick="$('#file_input').click();" data-disable-with="ファイル選択">
          <input type="text" name="filename" id="filename" value="">
          <input type="file" name="csv_file" id="file_input" style="display: none;" onchange="file_selected($(this));">
        </div>
        <div class="csv-btn ">
          <input type="submit" name="commit" value="CSVインポート" class="btn btn-primary " data-disable-with="CSVインポート">
        </div>
      </form>
    </div>
    
    <script type="text/javascript">
      function file_selected(file_field) {
        var filename = $(file_field)[0].files[0].name;
      $('#filename').val(filename);  
      }
    </script>

    <div class="col-md-10 col-md-offset-1">
      <%= will_paginate @user %>
      <table class="table table-condensed " id="table-users">
        <tbody>
          <tr class="blank_height">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <% @user.each do |user| %>
            <tr>
              <td><%= link_to user.name, user_path(user) %></td>
              <td class="center"><%= user.department.present? ? user.department : "未所属" %></td>
              <td class="center"><%= format_basic_info(user.basic_time) %></td>
              <td class="center"><%= format_basic_info(user.work_time) %></td>
              <td class="center">
                <% unless user.admin? %>
                  <%= link_to "基本情報編集", edit_basic_info_user_path(user), remote: true, class: "btn btn-success" %>
                  <%= link_to "削除", user, method: :delete,
                    data: { confirm: "削除してよろしいですか？" },
                    class: "btn btn-danger" %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>  
      </table>
      <%= will_paginate @user %>
    </div>
  </div>
</div>

<!-- モーダルウインドウ表示 -->
<div id="edit-basic-info" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>